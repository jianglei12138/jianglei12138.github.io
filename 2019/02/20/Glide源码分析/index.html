<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  
  
  <title>  Glide æºç åˆ†æ |   Lemon </title>

 
  
    <link rel="icon" href="/images/favicon.png">
  


  <link rel="stylesheet" href="/nayo.min.css"> 
</head>  
  <body>   
    
      <header class="header-wrapper">

  <nav class="inner">
    <div class="title">
    </div>

    <ul class="menu">
      
      
      <li class="item">
        <a class="link" id="menu-home" href="/">
          <i class="iconfont icon-home">
        </i></a>
      </li>
      
      
      
      <li class="item">
        <a class="link" id="menu-archives" href="/archives">
          <i class="iconfont icon-archives">
        </i></a>
      </li>
      
      
      
      <li class="item">
        <a class="link" id="menu-tags" href="/tags">
          <i class="iconfont icon-tags">
        </i></a>
      </li>
      
      
      
      <li class="item">
        <a class="link" id="menu-about" href="/about">
          <i class="iconfont icon-about">
        </i></a>
      </li>
      
      
      
      <li class="item">
        <a class="link" id="menu-search">
          <i class="iconfont icon-search">
        </i></a>
        

        
      
    </li></ul>
  </nav>
</header>

<header class="mobile-header-wrapper">
  <i id="mobile-toggle" class="iconfont icon-menu mobile-toggle"></i>
</header>   

      <div class="container">       
          
          
            <div class="container-inner">  
          

          <article class="post slideDownMin">
  
	
<div class="header">
		<p class="title">	
			Glide æºç åˆ†æ
		</p>
		<div class="info">	
			<time>
				Feb 20, 2019
			</time>

			
			
				<i class="iconfont icon-words"></i>
				<span class="words">19682
				</span>
			
		</div>
</div> 
	

    <script type="text/x-mathjax-config">
        var post = document.getElementsByClassName("post")[0];  
        MathJax.Hub.Config({
            showProcessingMessages: false,
            messageStyle: "none",    
            tex2jax: {
                inlineMath:  [ ["$", "$"] , ["\\(","\\)"]],
                displayMath: [ ["$$","$$"] , ["\\[","\\]"]],
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a'],
            },
            "HTML-CSS": {            
                showMathMenu: false
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub,post]);
    </script>
    <style>.MathJax{outline:0;}</style>

    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.2/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 

	  <div class="typo post-content ">

		

			
					<p>Androidå›¾ç‰‡åŠ è½½æ¡†æ¶çš„å‘å±•ï¼Œç»å†äº†ä»æœ€åˆçš„ImageLoderåˆ°Piassoï¼ŒGlideï¼ŒFrescoä¸‰è¶³é¼ç«‹çš„è¿‡ç¨‹ï¼Œå…¶ä¸­æ— è®ºæ˜¯Picassoè¿˜æ˜¯Glideï¼Œä»–ä»¬çš„å…±åŒç‚¹éƒ½æ˜¯ç”¨èµ·æ¥ç‰¹åˆ«æ–¹ä¾¿ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨ï¼Œå‡ ä¹å¯ä»¥ä¸€è¡Œä»£ç è§£å†³å¤§éƒ¨åˆ†çš„éœ€æ±‚ã€‚æœ¬æ–‡åŸºäºGlideæœ€æ–°çš„ç‰ˆæœ¬4.8ï¼Œå¯¹Glideæºç åšä¸€äº›ç®€è¦çš„åˆ†æã€‚<br> <a id="more"></a></p>
<p>Androidå›¾ç‰‡åŠ è½½æ¡†æ¶çš„å‘å±•ï¼Œç»å†äº†ä»æœ€åˆçš„ImageLoderåˆ°Piassoï¼ŒGlideï¼ŒFrescoä¸‰è¶³é¼ç«‹çš„è¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯å…³äºè¿™ä¸‰ä¸ªå¸¸ç”¨æ¡†æ¶çš„ä¸€äº›æ•°æ®ä¸Šçš„å¯¹æ¯”ã€‚</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">Picasso</th>
<th>Glide</th>
<th>Fresco</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å¼€å‘è€…</td>
<td align="left">square</td>
<td>bumptech</td>
<td>facebook</td>
</tr>
<tr>
<td align="center">Star/Issue</td>
<td align="left">16K+/1400+</td>
<td>24K+/3100+</td>
<td>15K+/1900+</td>
</tr>
<tr>
<td align="center">æœ€æ–°ç‰ˆæœ¬</td>
<td align="left">2.71828</td>
<td>4.8.0</td>
<td>1.11.0</td>
</tr>
</tbody></table>
<p>ä»ä¸Šè¿°è¡¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒGlideç›¸å¯¹å…¶ä»–ä¸¤ä¸ªæœ‰æ›´å¤šçš„starä¸issueï¼Œæœ¬æ–‡å°±ç®€å•åˆ†æä¸€ä¸‹Glideçš„æºç ã€‚Glideæ˜¯ç”±<a href="https://github.com/bumptech" target="_blank" rel="noopener">bumptech</a>å¼€å‘çš„å›¾ç‰‡åŠ è½½æ¡†æ¶ï¼Œä¹Ÿæ˜¯Googleæ¨èä½¿ç”¨çš„å›¾ç‰‡åŠ è½½æ¡†æ¶ã€‚</p>
<h2 id="Glideçš„ä½¿ç”¨"><a href="#Glideçš„ä½¿ç”¨" class="headerlink" title="Glideçš„ä½¿ç”¨"></a>Glideçš„ä½¿ç”¨</h2><p>é™¤å»å¸¸ç”¨çš„pngï¼Œjpgå¤–ï¼ŒGlideè¿˜æ”¯æŒ Gifã€WebPï¼Œç”šè‡³æ˜¯ Videoç­‰ï¼Œå½“ç„¶è¿™äº›éƒ½æ˜¯å»ºç«‹åœ¨ä¸€äº›ç¬¬ä¸‰æ–¹åº“çš„åŸºç¡€ä¸Šå®ç°çš„ï¼Œæ¯”å¦‚è¯´gifencoderç­‰ã€‚</p>
<p>æ— è®ºæ˜¯ä¸Šæ–‡è¯´åˆ°çš„Picassoè¿˜æ˜¯Glideï¼Œä»–ä»¬çš„å…±åŒç‚¹éƒ½æ˜¯ç”¨èµ·æ¥ç‰¹åˆ«æ–¹ä¾¿ï¼Œé€šè¿‡Glideçš„é“¾å¼è°ƒç”¨ï¼Œå‡ ä¹å¯ä»¥ä¸€è¡Œä»£ç è§£å†³å¤§éƒ¨åˆ†çš„éœ€æ±‚ã€‚æœ¬æ–‡åŸºäºGlideæœ€æ–°çš„ç‰ˆæœ¬4.8ï¼Œç›¸è¾ƒäºGlide 3ï¼ŒGlide 4åœ¨ä¸€äº›ä»£ç æ˜“è¯»æ€§ï¼Œæ˜“å†™æ€§ï¼Œå¯æ‰©å±•æ€§ç­‰æ–¹é¢éƒ½æœ‰äº†ä¸é”™çš„æå‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RequestOptions options = <span class="keyword">new</span> RequestOptions()</span><br><span class="line">        .diskCacheStrategy(DiskCacheStrategy.NONE);</span><br><span class="line">        .placeholder(R.drawable.loading);</span><br><span class="line">Glide.with(<span class="keyword">this</span>).load(url).apply(options).into(imageView);</span><br></pre></td></tr></table></figure>
<h2 id="Glideæ¶æ„"><a href="#Glideæ¶æ„" class="headerlink" title="Glideæ¶æ„"></a>Glideæ¶æ„</h2><p><img src="/2019/02/20/Glide%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/framework.png" alt="framework"><br>å¦‚å›¾æ˜¯æˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ä¸€å¼ å…³äºglideæ¶æ„å›¾ã€‚å¯ä»¥çœ‹åˆ°Glideç›¸å¯¹è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæ­¤æ¬¡æˆ‘ä»¬åªåˆ†æå…¶ä¸­çš„éƒ¨åˆ†å®ç°ï¼Œå³Registryä¸RequestManagerï¼Œäº†è§£ä¸€ä¸‹GlideåŠ è½½ä¸€å¼ å›¾ç‰‡çš„å¤§è‡´æµç¨‹ã€‚</p>
<h2 id="Glideæºç åˆ†æ"><a href="#Glideæºç åˆ†æ" class="headerlink" title="Glideæºç åˆ†æ"></a>Glideæºç åˆ†æ</h2><p>äº†è§£è¿‡Glideä½¿ç”¨åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ç€æ‰‹åˆ†æGlideæºç äº†ï¼Œåé¢æˆ‘ä»¬ä¸€è¾¹ç»“åˆè®¾è®¡æ¨¡å¼ï¼Œä¸€éåˆ†æGlideçš„å®ç°ã€‚</p>
<h3 id="1-Glideçš„åˆå§‹åŒ–"><a href="#1-Glideçš„åˆå§‹åŒ–" class="headerlink" title="1. Glideçš„åˆå§‹åŒ–"></a>1. Glideçš„åˆå§‹åŒ–</h3><p>ä»Glideæºç å…¥æ‰‹ï¼Œæˆ‘ä»¬é€å±‚åˆ†æGlideæ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Œé¦–å…ˆä»withæ¥å£å…¥æ‰‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> RequestManager <span class="title">with</span><span class="params">(@NonNull Context context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Glide.get(context).getRequestManagerRetriever().get(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³äºwithçš„è°ƒç”¨å¯ä»¥ç®€åŒ–å¦‚ä¸Šï¼Œå¯ä»¥çœ‹åˆ°é€šè¿‡ <strong>Glide#get</strong>æ–¹æ³•è·å–åˆ°Glideå®ä¾‹ï¼Œé‚£ä¹ˆè¿™ä¸ªgetæ–¹æ³•ç©¶ç«Ÿåšäº†äº›ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Glide glide;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> isInitializing;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Glide <span class="title">get</span><span class="params">(@NonNull Context context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (glide == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (Glide.class) &#123;</span><br><span class="line">      <span class="keyword">if</span> (glide == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isInitializing) &#123;</span><br><span class="line">      	   <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">""</span>);</span><br><span class="line">    	&#125;</span><br><span class="line">    	isInitializing = <span class="keyword">true</span>;</span><br><span class="line">   		initializeGlide(context);</span><br><span class="line">    	isInitializing = <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> glide;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯è§åˆ›å»ºé‡‡ç”¨äº†å•ä¾‹æ¨¡å¼ï¼Œå•ä¾‹æ¨¡å¼æ˜¯æˆ‘ä»¬æœ€é•¿è§ã€æœ€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œæ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚</p>
<blockquote>
<p><strong>å•ä¾‹æ¨¡å¼(Singleton Pattern)ï¼šç¡®ä¿æŸä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸”è‡ªè¡Œå®ä¾‹åŒ–å¹¶å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªç±»ç§°ä¸ºå•ä¾‹ç±»ï¼Œå®ƒæä¾›å…¨å±€è®¿é—®çš„æ–¹æ³•ã€‚</strong></p>
</blockquote>
<p>å…³äºå•ä¾‹çš„å®ç°æœ‰å¾ˆå¤šç§ä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€è°“é’èœèåœå„æœ‰æ‰€çˆ±ï¼ŒGlideä½¿ç”¨äº†åŒé‡æ£€æŸ¥é”çš„æ–¹æ¡ˆï¼Œå¹¶ä¸”ä¸ºäº†é˜²æ­¢å¯èƒ½å‡ºç°çš„é‡å¤åˆ›å»ºï¼Œä½¿ç”¨äº†å¸ƒå°”å˜é‡æ ‡è¯†æ˜¯å¦åˆå§‹åŒ–å®Œæˆã€‚æ­¤å¤„éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­å¸¸ç”¨çš„å•åˆ©å¯èƒ½ä¸ä¼šä¼ é€’ä¸€ä¸ªå‚æ•°Contextï¼Œå¦‚æœéœ€è¦ï¼Œéœ€è¦ç‰¹æ®Šæ³¨æ„å¯¹Contextçš„ä½¿ç”¨ï¼Œé¿å…ä¸å¿…è¦çš„å†…å­˜æ³„æ¼ã€‚</p>
<p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œåˆ›å»ºGlideå®ä¾‹æœ€ç»ˆåº”è¯¥ç”± <strong>initializeGlide</strong> å®Œæˆï¼Œå…·ä½“å®ç°å¦‚ä¸‹, å…¶ä¸­å…³äºGlideModuleçš„å®ç°ï¼Œç›®å‰æˆ‘ä»¬åªéœ€è¦çŸ¥é“æ˜¯ç”¨æ¥ä¿®æ”¹Glideçš„åŠ è½½ç­–ç•¥ä»¥åŠè®¾ç½®ç¼“å­˜ç­‰å³å¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initializeGlide</span><span class="params">(@NonNull Context context)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// GlideBuilderé¡¾åæ€ä¹‰ï¼Œåˆ›å»ºGlide</span></span><br><span class="line">    initializeGlide(context, <span class="keyword">new</span> GlideBuilder());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">initializeGlide</span><span class="params">(@NonNull Context context, @NonNull GlideBuilder builder)</span> </span>&#123;</span><br><span class="line">    Context applicationContext = context.getApplicationContext();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Glide 4æ”¯æŒé€šè¿‡æ³¨è§£AppGlideModule, ç”±äºGlideModuleå³å°†åºŸå¼ƒï¼Œä¸åšä»‹ç»</span></span><br><span class="line">    GeneratedAppGlideModule annotationGeneratedModule = getAnnotationGeneratedGlideModules();</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    RequestManagerRetriever.RequestManagerFactory factory =</span><br><span class="line">        annotationGeneratedModule != <span class="keyword">null</span></span><br><span class="line">        ? annotationGeneratedModule.getRequestManagerFactory() : <span class="keyword">null</span>;</span><br><span class="line">    builder.setRequestManagerFactory(factory);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (annotationGeneratedModule != <span class="keyword">null</span>) &#123;</span><br><span class="line">        annotationGeneratedModule.applyOptions(applicationContext, builder);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¤å¤„çœŸæ­£åˆ›å»ºglideå¯¹è±¡</span></span><br><span class="line">    Glide glide = builder.build(applicationContext);</span><br><span class="line">    <span class="keyword">for</span> (com.bumptech.glide.<span class="keyword">module</span>.GlideModule <span class="keyword">module</span> : manifestModules) &#123;</span><br><span class="line">        <span class="keyword">module</span>.registerComponents(applicationContext, glide, glide.registry);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (annotationGeneratedModule != <span class="keyword">null</span>) &#123;</span><br><span class="line">        annotationGeneratedModule.registerComponents(applicationContext, glide, glide.registry);</span><br><span class="line">    &#125;</span><br><span class="line">    Glide.glide = glide;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“èµ·æ¥å¯ä»¥çœ‹åˆ° <strong>initializeGlide</strong> åªåšäº†ä¸¤ä»¶äº‹æƒ…ï¼Œåˆå§‹åŒ–GeneratedAppGlideModuleï¼Œå¹¶é€šè¿‡GlideBuilder åˆ›å»ºglideã€‚ç»ˆäºæˆ‘ä»¬çœ‹åˆ°Glideå®ä¾‹çš„åˆ›å»ºï¼Œç»§ç»­è·Ÿä¸‹å»å¯ä»¥çœ‹åˆ°ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Glide <span class="title">build</span><span class="params">(@NonNull Context context)</span> </span>&#123;</span><br><span class="line">      memorySizeCalculator = <span class="keyword">new</span> MemorySizeCalculator.Builder(context).build();</span><br><span class="line">      connectivityMonitorFactory = <span class="keyword">new</span> DefaultConnectivityMonitorFactory();</span><br><span class="line"></span><br><span class="line">      bitmapPool = <span class="keyword">new</span> LruBitmapPool(size);</span><br><span class="line">      arrayPool = <span class="keyword">new</span> LruArrayPool(memorySizeCalculator.getArrayPoolSizeInBytes());</span><br><span class="line">      memoryCache = <span class="keyword">new</span> LruResourceCache(memorySizeCalculator.getMemoryCacheSize());</span><br><span class="line">      diskCacheFactory = <span class="keyword">new</span> InternalCacheDiskCacheFactory(context);</span><br><span class="line"></span><br><span class="line">      engine =</span><br><span class="line">          <span class="keyword">new</span> Engine(</span><br><span class="line">              memoryCache,</span><br><span class="line">              diskCacheFactory,</span><br><span class="line">              GlideExecutor.newDiskCacheExecutor(),</span><br><span class="line">              GlideExecutor.newSourceExecutor(),</span><br><span class="line">              GlideExecutor.newUnlimitedSourceExecutor(),</span><br><span class="line">              GlideExecutor.newAnimationExecutor(),</span><br><span class="line">              isActiveResourceRetentionAllowed);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (defaultRequestListeners == <span class="keyword">null</span>) &#123;</span><br><span class="line">      defaultRequestListeners = Collections.emptyList();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      defaultRequestListeners = Collections.unmodifiableList(defaultRequestListeners);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    RequestManagerRetriever requestManagerRetriever =</span><br><span class="line">        <span class="keyword">new</span> RequestManagerRetriever(requestManagerFactory);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Glide(</span><br><span class="line">        context,</span><br><span class="line">        engine,</span><br><span class="line">        memoryCache,</span><br><span class="line">        bitmapPool,</span><br><span class="line">        arrayPool,</span><br><span class="line">        requestManagerRetriever,</span><br><span class="line">        connectivityMonitorFactory,</span><br><span class="line">        logLevel,</span><br><span class="line">        defaultRequestOptions.lock(),</span><br><span class="line">        defaultTransitionOptions,</span><br><span class="line">        defaultRequestListeners,</span><br><span class="line">        isLoggingRequestOriginsEnabled);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>Glide#build</strong>åˆ›å»ºäº†Glideçš„å¼•æ“ï¼Œbitmpæ± ï¼Œå†…å­˜ç¼“å­˜ï¼Œç£ç›˜ç¼“å†²ï¼ŒåŠ è½½èµ„æºå’Œè¯»å–èµ„æºçš„çº¿ç¨‹æ± ï¼Œç¼“å­˜æ–¹å¼ç­‰ï¼Œå…³äºRequestManagerRetrieverçš„ä»‹ç»ï¼Œå‚è§ç¬¬äºŒèŠ‚ã€‚æœ€ç»ˆè°ƒç”¨Glideçš„æ„é€ å‡½æ•°åˆ›å»ºGlideå¯¹è±¡ã€‚</p>
<h3 id="2-Registryæœºåˆ¶"><a href="#2-Registryæœºåˆ¶" class="headerlink" title="2. Registryæœºåˆ¶"></a>2. Registryæœºåˆ¶</h3><p>Glideæ„é€ å‡½æ•°å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">Glide(</span><br><span class="line">    <span class="meta">@NonNull</span> Context context,</span><br><span class="line">    <span class="meta">@NonNull</span> Engine engine,</span><br><span class="line">    <span class="meta">@NonNull</span> MemoryCache memoryCache,</span><br><span class="line">    <span class="meta">@NonNull</span> BitmapPool bitmapPool,</span><br><span class="line">    <span class="meta">@NonNull</span> ArrayPool arrayPool,</span><br><span class="line">    <span class="meta">@NonNull</span> RequestManagerRetriever requestManagerRetriever ...) &#123;</span><br><span class="line">    ...</span><br><span class="line">    registry = <span class="keyword">new</span> Registry();</span><br><span class="line">    registry</span><br><span class="line">        .append(ByteBuffer.class, <span class="keyword">new</span> ByteBufferEncoder())</span><br><span class="line">        .append(InputStream.class, <span class="keyword">new</span> StreamEncoder(arrayPool))</span><br><span class="line">        <span class="comment">/* Bitmaps */</span></span><br><span class="line">        .append(Registry.BUCKET_BITMAP, ByteBuffer.class, Bitmap.class, byteBufferBitmapDecoder)</span><br><span class="line">        <span class="comment">/* BitmapDrawables */</span></span><br><span class="line">        .append(</span><br><span class="line">        Registry.BUCKET_BITMAP_DRAWABLE,</span><br><span class="line">        ByteBuffer.class,</span><br><span class="line">        BitmapDrawable.class,</span><br><span class="line">        <span class="keyword">new</span> BitmapDrawableDecoder&lt;&gt;(resources, byteBufferBitmapDecoder))</span><br><span class="line">        <span class="comment">/* GIFs */</span></span><br><span class="line">        .append(</span><br><span class="line">        Registry.BUCKET_GIF,</span><br><span class="line">        InputStream.class,</span><br><span class="line">        GifDrawable.class,</span><br><span class="line">        <span class="keyword">new</span> StreamGifDecoder(imageHeaderParsers, byteBufferGifDecoder, arrayPool))</span><br><span class="line">        <span class="comment">/* GIF Frames */</span></span><br><span class="line">        .append(</span><br><span class="line">        GifDecoder.class, GifDecoder.class, UnitModelLoader.Factory.&lt;GifDecoder&gt;getInstance())</span><br><span class="line">        .append(</span><br><span class="line">        Registry.BUCKET_BITMAP,</span><br><span class="line">        GifDecoder.class,</span><br><span class="line">        Bitmap.class,</span><br><span class="line">        <span class="keyword">new</span> GifFrameResourceDecoder(bitmapPool))</span><br><span class="line">        <span class="comment">/* Drawables */</span></span><br><span class="line">        .append(Uri.class, Drawable.class, resourceDrawableDecoder)</span><br><span class="line">        <span class="comment">/* Transcoders */</span></span><br><span class="line">        .register(</span><br><span class="line">        Bitmap.class,</span><br><span class="line">        BitmapDrawable.class,</span><br><span class="line">        <span class="keyword">new</span> BitmapDrawableTranscoder(resources));</span><br><span class="line">    ...</span><br><span class="line">    glideContext =</span><br><span class="line">        <span class="keyword">new</span> GlideContext(</span><br><span class="line">        context,</span><br><span class="line">        arrayPool,</span><br><span class="line">        registry,</span><br><span class="line">        <span class="keyword">new</span> ImageViewTargetFactory(),</span><br><span class="line">        defaultRequestOptions,</span><br><span class="line">        defaultTransitionOptions,</span><br><span class="line">        defaultRequestListeners,</span><br><span class="line">        engine);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Glideæ„é€ å‡½æ•°ä¸­æ³¨å†Œäº†å¤§é‡çš„Transcoder, Encoderä¸Decoderï¼ˆè´Ÿè´£ä¸€äº›èµ„æºå¦‚jpg, svg, video, gifç­‰åŠ è½½ï¼ŒæŒä¹…åŒ–ç­‰ï¼‰ï¼Œæ‰€æœ‰çš„è¿™äº›æ“ä½œç”±ä¸€ä¸ªä¸ªç‹¬ç«‹çš„æ¨¡å—å®ç°ï¼Œè¿™äº›æ¨¡å—ç”±Registryè´Ÿè´£ç®¡ç†ã€‚Registryæ˜¯Glideå†…éƒ¨å®ç°çš„æ¨¡å—æŒ‚æ¥ä¸­å¿ƒï¼Œå®ƒå»ºç«‹äº†åŠŸèƒ½éœ€æ±‚å’Œå®ç°æ¨¡å—ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œä½¿è¿™äº›æ¨¡å—èƒ½å¤Ÿæ ¹æ®éœ€æ±‚è¿›è¡Œçµæ´»çš„æŒ‚è½½ï¼Œæ¨¡å—å’Œæ¨¡å—ä¹‹é—´åˆç›¸äº’ç‹¬ç«‹äº’ä¸å½±å“ï¼Œå¾ˆå¥½åœ°å®ç°äº†ç³»ç»ŸåŠŸèƒ½çš„è§£è€¦ã€‚  åœ¨Registryå†…éƒ¨æä¾›äº†å¯¹å¦‚ä¸‹å‡ ç§ç±»å‹æ¨¡å—çš„æŒ‚è½½æ”¯æŒ</p>
<ul>
<li>æ•°æ®åŠ è½½æ¨¡å— ModelLoaderRegistry</li>
<li>å­˜å‚¨æ¨¡å—ï¼Œæä¾›é€šç”¨çš„æ•°æ®æŒä¹…åŒ–åŠŸèƒ½ EncoderRegistry</li>
<li>èµ„æºè§£ç æ¨¡å—ï¼ŒæŠŠå„ç§ç±»å‹çš„æ•°æ®decodeæˆbitmapæˆ–è€…drawableèµ„æº ResourceDecoderRegistry</li>
<li>èµ„æºå­˜å‚¨æ¨¡å—ï¼Œç›¸æ¯”EncoderRegistryæ­¤åªæ˜¯èµ„æºbitmapï¼Œdrawableç­‰æŒä¹…åŒ–æ¨¡å— ResourceEncoderRegistry</li>
<li>æ•°æ®æµé‡å®šå‘æ¨¡å—  DataRewinderRegistry</li>
<li>æ•°æ®è½¬æ¢æ¨¡å—ï¼Œå°†ä¸åŒç±»ä¼¼çš„èµ„æºè½¬æ¢ï¼Œå¦‚bitmap -&gt; drawable</li>
<li>å›¾ç‰‡headerè§£ææ¨¡å— ImageHeaderParserRegistry</li>
</ul>
<p>å…³äºæ¨¡å—é—´çš„å…³ç³»å’ŒGlideæ”¯æŒçš„éƒ¨åˆ†æ¨¡å—å¯ä»¥å‚è€ƒå¦‚ä¸‹UMLå›¾ï¼Œå…³äºModelLoaderRegistryæ¨¡å—ï¼Œå¯ä»¥çœ‹åˆ°æ”¯æŒOkhttpä½œä¸ºç½‘ç»œè¯·æ±‚æˆ–è€…ä½ å¯ä»¥è‡ªå®šä¹‰ä»»æ„çš„ç½‘ç»œè¯·æ±‚å·¥å…·ï¼Œåªè¦å®ç°ModelLoaderFactoryæ¥å£å³å¯ï¼Œç”šè‡³ï¼Œå¯¹äºæ‰€æœ‰çš„æ¨¡å—ï¼Œå¦‚æœä¸èƒ½å¤Ÿæ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œå®Œå…¨å¯ä»¥è‡ªå®šä¹‰å±äºè‡ªå·±çš„æ¨¡å—ã€‚</p>
<p><img src="/2019/02/20/Glide%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/registry.jpg" alt="registry"></p>
<p>è¿™é‡Œï¼Œå…¶å®å°±æœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹ç­–ç•¥æ¨¡å¼çš„å‘³é“äº†ã€‚ç»“åˆUMLç±»å›¾å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºä»»æ„çš„æ¨¡å—ï¼Œå…¶å…·ä½“å®ç°ç±»å°±æ˜¯å…·ä½“çš„ç­–ç•¥ï¼Œå°†æ¥å£çš„å®šä¹‰ä¸å…·ä½“æ¨¡å—å®ç°ç­–ç•¥åˆ†å¼€ï¼Œç¬¦åˆâ€œä¾èµ–å€’è½¬åŸåˆ™â€ã€‚åœ¨æœ‰æ–°çš„æ¯”å¦‚è¯´endcoderæ—¶ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„å®ç°äº†Encoderå…·ä½“ç­–ç•¥ç±»å³å¯ã€‚</p>
<blockquote>
<p><strong>ç­–ç•¥æ¨¡å¼ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ç±»ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œç­–ç•¥æ¨¡å¼è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ã€‚ç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚</strong></p>
</blockquote>
<p>è‡³æ­¤ï¼ŒGlideåˆå§‹åŒ–å®Œæ¯•ã€‚</p>
<h3 id="3-RequestManagerçš„åˆ›å»º"><a href="#3-RequestManagerçš„åˆ›å»º" class="headerlink" title="3. RequestManagerçš„åˆ›å»º"></a>3. RequestManagerçš„åˆ›å»º</h3><p>Glideçš„æ‰€æœ‰ä¸€åˆ‡ä»¥withå¼€å§‹ï¼Œintoç»“æŸï¼Œwithæ”¯æŒcontext, activity, view, fragmentå‚æ•°ç­‰ï¼ŒGlideæ­£æ˜¯ä½¿ç”¨æ­¤ï¼Œæ¥å®ŒæˆåŸºæœ¬çš„åˆå§‹åŒ–ä¸è°ƒç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> RequestManager <span class="title">with</span><span class="params">(@NonNull Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Glide.get(context).getRequestManagerRetriever().get(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­getRequestManagerRetrieverå¾—åˆ°çš„å¯¹è±¡å…¶å®å°±æ˜¯åœ¨åˆå§‹åŒ–Glideçš„æ—¶å€™æ„é€ å‡½æ•°ä¼ å…¥çš„ï¼Œç”±GlideBuilderåˆ›å»ºçš„RequestManagerRetrieverï¼ŒRequestManagerRetrieveræä¾›äº†ä¸€ç³»åˆ—é™æ€æ–¹æ³•ç”¨æ¥åˆ›å»ºRequestManageræˆ–è€…ç›´æ¥ä»Actiivtyæˆ–è€…fragmentå–å¾—å·²ç»åˆ›å»ºçš„RequestManagerï¼Œå…³äºå¦‚ä½•è·å–ï¼Œè§getæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> RequestManager <span class="title">get</span><span class="params">(@NonNull Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Util.isOnMainThread() &amp;&amp; !(context <span class="keyword">instanceof</span> Application)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (context <span class="keyword">instanceof</span> FragmentActivity) &#123;</span><br><span class="line">            <span class="keyword">return</span> get((FragmentActivity) context);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (context <span class="keyword">instanceof</span> Activity) &#123;</span><br><span class="line">            <span class="keyword">return</span> get((Activity) context);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (context <span class="keyword">instanceof</span> ContextWrapper) &#123;</span><br><span class="line">            <span class="keyword">return</span> get(((ContextWrapper) context).getBaseContext());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> getApplicationManager(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ æœ‰å»ç¿»<strong>RequestManagerRetriever#get</strong>å®ç°ï¼Œä½ ä¼šå‘ç°getæ–¹æ³•æœ‰å¾ˆå¤šé‡è½½å‡½æ•°ï¼Œä½†æ— ä¸€ä¾‹å¤–ï¼Œæ‰€æœ‰çš„getå‡½æ•°æœ€å¼€å§‹éƒ½æœ‰å…³äºå½“å‰çº¿ç¨‹çš„æ£€æµ‹ï¼Œä¸ºä»€ä¹ˆè¦å»æ£€æµ‹æ˜¯å¦åˆ™ä¸»çº¿ç¨‹ï¼Ÿåé¢ä¼šæœ‰ç®€å•çš„æ³¨é‡Šã€‚å¦å¤–æˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸ªäº‹å®æ˜¯ï¼š</p>
<blockquote>
<p>Glideå®ç°ä¸­å›¾ç‰‡çš„åŠ è½½ä»»åŠ¡ä¼šä¸activityæˆ–è€…Fragmentçš„ç”Ÿå‘½å‘¨æœŸç»‘å®šï¼Œå½“ç•Œé¢æ‰§è¡ŒonStopçš„ä½¿ç”¨è‡ªåŠ¨æš‚åœï¼Œè€Œå½“æ‰§è¡ŒonStartçš„æ—¶å€™åˆä¼šè‡ªåŠ¨é‡æ–°å¼€å¯ï¼ŒåŒæ ·çš„ï¼ŒåŠ¨æ€Gifå›¾çš„åŠ è½½ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä»¥ç”¨æ¥èŠ‚çœç”µé‡ï¼ŒåŒæ—¶Glideä¼šå¯¹ç½‘ç»œçŠ¶æ€åšç›‘å¬ï¼Œå½“ç½‘ç»œçŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šé‡å¯å¤±è´¥çš„ä»»åŠ¡ï¼Œä»¥å‡å°‘ä»»åŠ¡å› ç½‘ç»œè¿æ¥é—®é¢˜è€Œå¤±è´¥çš„æ¦‚ç‡ã€‚</p>
</blockquote>
<p>æ—¢ç„¶å¦‚æ­¤æ–°çš„é—®é¢˜å°±äº§ç”Ÿäº†ï¼ŒGlideæ˜¯å¦‚ä½•æŠŠActivity/Fragmentçš„ç”Ÿå‘½å‘¨æœŸä¸è‡ªå·±ç»‘å®šçš„å‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­çœ‹åˆšæ‰çš„ä»£ç å¯»æ‰¾ç­”æ¡ˆï¼Œgetå‡½æ•°å¦‚æœæ£€æµ‹åˆ°æ˜¯ä¸»çº¿ç¨‹ï¼Œæœ€ç»ˆä¼šè°ƒç”¨å¦‚ä¸‹çš„å‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> RequestManager <span class="title">fragmentGet</span><span class="params">(@NonNull Context context,</span></span></span><br><span class="line"><span class="function"><span class="params">                                   @NonNull android.app.FragmentManager fm,</span></span></span><br><span class="line"><span class="function"><span class="params">                                   @Nullable android.app.Fragment parentHint,</span></span></span><br><span class="line"><span class="function"><span class="params">                                   <span class="keyword">boolean</span> isParentVisible)</span> </span>&#123;</span><br><span class="line">    RequestManagerFragment current = getRequestManagerFragment(fm, parentHint, isParentVisible);</span><br><span class="line">    RequestManager requestManager = current.getRequestManager();</span><br><span class="line">    <span class="keyword">if</span> (requestManager == <span class="keyword">null</span>) &#123;</span><br><span class="line">        Glide glide = Glide.get(context);</span><br><span class="line">        requestManager =</span><br><span class="line">            DEFAULT_FACTORY.build(</span><br><span class="line">            glide, current.getGlideLifecycle(), current.getRequestManagerTreeNode(), context);</span><br><span class="line">        current.setRequestManager(requestManager);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> requestManager;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> RequestManagerFragment <span class="title">getRequestManagerFragment</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    @NonNull <span class="keyword">final</span> android.app.FragmentManager fm,</span></span></span><br><span class="line"><span class="function"><span class="params">    @Nullable android.app.Fragment parentHint,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">boolean</span> isParentVisible)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    RequestManagerFragment current = (RequestManagerFragment) fm.findFragmentByTag(FRAGMENT_TAG);</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="keyword">null</span>) &#123;</span><br><span class="line">        current = <span class="keyword">new</span> RequestManagerFragment();</span><br><span class="line">        current.setParentFragmentHint(parentHint);</span><br><span class="line">        <span class="keyword">if</span> (isParentVisible) &#123;</span><br><span class="line">            current.getGlideLifecycle().onStart();</span><br><span class="line">        &#125;</span><br><span class="line">        fm.beginTransaction().add(current, FRAGMENT_TAG).commitAllowingStateLoss();</span><br><span class="line">        handler.obtainMessage(ID_REMOVE_FRAGMENT_MANAGER, fm).sendToTarget();</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> current;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> RequestManagerFactory DEFAULT_FACTORY = <span class="keyword">new</span> RequestManagerFactory() &#123;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RequestManager <span class="title">build</span><span class="params">(@NonNull Glide glide, @NonNull Lifecycle lifecycle,</span></span></span><br><span class="line"><span class="function"><span class="params">                                @NonNull RequestManagerTreeNode requestManagerTreeNode, @NonNull Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RequestManager(glide, lifecycle, requestManagerTreeNode, context);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>RequestManagerRetriever#fragmentGet</strong>ä¼šå…ˆå»æŸ¥æ‰¾TAGä¸ºFRAGMENT_TAGçš„ fragmentï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œä¼šè‡ªå·±åˆ›å»ºä¸€ä¸ªSupportRequestManagerFragmentï¼Œè¿™ä¸ªSupportRequestManagerFragmentæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿç¿»ä¸‹ä»£ç ä½ å°±ä¼šå‘ç°è¿™ç«Ÿç„¶æ˜¯ä¸ªFragmentï¼ä¸éš¾å¤§èƒ†çŒœæµ‹ï¼ŒGlideä¸Lifecycleç»„ä»¶ä¸€æ ·ï¼Œå¡äº†ä¸€ä¸ªç©ºç™½çš„Fragmentæ¥ç›‘å¬ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒï¼</p>
<p>ç´§æ¥ç€ï¼Œå°±æ˜¯RequestManagerçš„åˆ›å»ºï¼Œé€šè¿‡DEFAULT_FACTORYå¯¹è±¡çš„buildå‡½æ•°å®ç°ï¼Œä¸‹é¢çœ‹RequestManagerçš„æ„é€ å‡½æ•°çš„å®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">RequestManager(</span><br><span class="line">    Glide glide,</span><br><span class="line">    Lifecycle lifecycle,</span><br><span class="line">    RequestManagerTreeNode treeNode,</span><br><span class="line">    RequestTracker requestTracker,</span><br><span class="line">    ConnectivityMonitorFactory factory,</span><br><span class="line">    Context context) &#123;</span><br><span class="line">    <span class="keyword">this</span>.glide = glide;</span><br><span class="line">    <span class="keyword">this</span>.lifecycle = lifecycle;</span><br><span class="line">    <span class="keyword">this</span>.treeNode = treeNode;</span><br><span class="line">    <span class="keyword">this</span>.requestTracker = requestTracker;</span><br><span class="line">    <span class="keyword">this</span>.context = context;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we're the application level request manager, we may be created on a background thread.</span></span><br><span class="line">    <span class="comment">// In that case we cannot risk synchronously pausing or resuming requests, so we hack around the</span></span><br><span class="line">    <span class="comment">// issue by delaying adding ourselves as a lifecycle listener by posting to the main thread.</span></span><br><span class="line">    <span class="comment">// This should be entirely safe.</span></span><br><span class="line">    <span class="keyword">if</span> (Util.isOnBackgroundThread()) &#123;</span><br><span class="line">        mainHandler.post(addSelfToLifecycle);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        lifecycle.addListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    glide.registerRequestManager(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªlifecycleæ˜¯ä»€ä¹ˆï¼Ÿæ˜¯é€šè¿‡SupportRequestManagerFragmentä¸­getGlideLifecycleå–å¾—ï¼Œå…·ä½“æ¥è¯´æ˜¯ActivityFragmentLifecycleå¯¹è±¡ï¼ŒActivityFragmentLifecycleç»´æŠ¤äº†ä¸€ä»½æ³¨å†Œçš„ç”Ÿå‘½å‘¨æœŸå›è°ƒSetï¼Œå½“ç©ºç™½fragmentç”Ÿå‘½å‘¨æœŸå‘ç”Ÿæ”¹å˜ï¼Œä¼šå»è°ƒç”¨ActivityFragmentLifecycleç›¸åº”çš„æ¥å£ï¼Œå†å»éå†ç›¸åº”æˆ‘ä»¬æ³¨å†Œçš„å›è°ƒSetï¼Œæ¯”å¦‚è¯´RequestManagerï¼è‡³æ­¤ï¼Œè±ç„¶å¼€æœ—ï¼Œä¸€åˆ‡å’Œæˆ‘ä»¬é¢„æ–™çš„ç›¸åŒã€‚ä¼˜ç§€ï¼</p>
<p>å¦å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°æ³¨é‡Šä¸­å…³äºä¸ºä»€ä¹ˆä½¿ç”¨ä¸»çº¿ç¨‹çš„åˆ¤æ–­åŸå› ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥åœ¨Applicationä¸­è°ƒç”¨åˆ›å»ºäº†RequestManagerå¯èƒ½ä¼šæœ‰åŒæ­¥çš„é£é™©ï¼Œå¯¼è‡´ç”Ÿå‘½å‘¨æœŸæ··ä¹±ï¼ğŸ‘ğŸ‘ğŸ‘</p>
<h3 id="4-RequestBuilderåˆ›å»º"><a href="#4-RequestBuilderåˆ›å»º" class="headerlink" title="4. RequestBuilderåˆ›å»º"></a>4. RequestBuilderåˆ›å»º</h3><p>RequestManagerå¯¹è±¡åˆ›å»ºå®Œæˆï¼Œæ—¢å¯ä»¥ç ”ç©¶ä¸€ä¸‹loadçš„å®ç°å•¦ï¼ŒåŒæ ·loadæ¥å£ä¹Ÿæœ‰å¤§é‡çš„é‡è½½ï¼Œé‚£ä»æˆ‘ä»¬æˆ‘ä»¬å¸¸ç”¨çš„  load(Drawable) å…¥æ‰‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> RequestBuilder&lt;Drawable&gt; <span class="title">load</span><span class="params">(@Nullable Drawable drawable)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> asDrawable().load(drawable);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> RequestBuilder&lt;Drawable&gt; <span class="title">asDrawable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> as(Drawable.class);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> &lt;ResourceType&gt; <span class="function">RequestBuilder&lt;ResourceType&gt; <span class="title">as</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    @NonNull Class&lt;ResourceType&gt; resourceClass)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RequestBuilder&lt;&gt;(glide, <span class="keyword">this</span>, resourceClass, context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>loadæ“ä½œå…ˆé€šè¿‡asæ¥å£æŠŠéœ€è¦åŠ è½½çš„å¯¹è±¡å°è£…æˆäº†RequestBuilderï¼Œæœ€ç»ˆæŠŠloadçš„ä»»åŠ¡äº¤ç»™äº†RequestBuilderå®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> RequestBuilder&lt;TranscodeType&gt; <span class="title">load</span><span class="params">(@Nullable Drawable drawable)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> loadGeneric(drawable)</span><br><span class="line">        .apply(diskCacheStrategyOf(DiskCacheStrategy.NONE));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> RequestBuilder&lt;TranscodeType&gt; <span class="title">loadGeneric</span><span class="params">(@Nullable Object model)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.model = model;</span><br><span class="line">    isModelSet = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå…³äºç£ç›˜ç¼“å†²çš„å¤„ç†ä¹Ÿæ˜¯ä¸€ä¸ªå…¸å‹çš„ç­–ç•¥æ¨¡å¼çš„å®ç°ã€‚loadæœ€ç»ˆå®ç°ä¹Ÿåªæ˜¯ç»™æˆå‘˜å˜é‡èµ‹å€¼ï¼ŒRequestBuilderçš„æ‰€æœ‰æä¾›ç»™åº”ç”¨ä½¿ç”¨çš„æ¥å£ï¼Œå¤§éƒ¨åˆ†å®ç°ä¹Ÿéƒ½æ˜¯è®¾ç½®æˆå‘˜å˜é‡ç­‰ï¼Œæ— çœŸæ­£é€»è¾‘çš„å¤„ç†ã€‚ä½†æ˜¯å…¶ä¸­çš„é“¾å¼è°ƒç”¨ä¸ä»…è®©æˆ‘ä»¬æƒ³èµ·è®¾è®¡æ¨¡å¼ä¸­çš„å»ºé€ è€…æ¨¡å¼ï¼Œåˆ›å»ºè€…æ¨¡å¼æ˜¯å¤‡å—å¼€å‘è€…åˆ›å»ºå¤æ‚å¯¹è±¡æ—¶é’ççš„ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚è€Œå…¶ä¸­é“¾å¼è°ƒç”¨ä¸€èˆ¬ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸ç”¨çš„å®ç°åˆ›å»ºè€…æ¨¡å¼çš„ä¸€ç§æ‰‹æ®µã€‚</p>
<blockquote>
<p><strong>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚å»ºé€ è€…æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼</strong></p>
</blockquote>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±åˆ›å»ºå¥½äº†ä¸€ä¸ªRequestBuilderå¯¹è±¡.</p>
<h3 id="5-Requestæ„å»º"><a href="#5-Requestæ„å»º" class="headerlink" title="5. Requestæ„å»º"></a>5. Requestæ„å»º</h3><p>ä¸‡äº‹å…·å¤‡ï¼Œåªå·®å¦‚ä½•æŠŠèµ„æºå¾—åˆ°å¹¶æ˜¾ç¤ºäº†ï¼Œè¿™é‡Œå°±ä¸å¾—ä¸è¯´RequestBuilderä¸­çš„intoæ–¹æ³•ï¼Œå¦‚ä¸‹æ˜¯intoçš„éƒ¨åˆ†æºç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ViewTarget&lt;ImageView, TranscodeType&gt; <span class="title">into</span><span class="params">(@NonNull ImageView view)</span> </span>&#123;</span><br><span class="line">    BaseRequestOptions&lt;?&gt; requestOptions = <span class="keyword">this</span>;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> into(</span><br><span class="line">        <span class="comment">// ç®€åŒ–äº†éƒ¨åˆ†ä»£ç ï¼Œå¯¹äºåœ¨åˆ›å»ºRequestBuilderä¼ å…¥çš„Drawable.classï¼Œæ­¤å¤„ä¼šåˆ›å»ºDrawableImageViewTarget</span></span><br><span class="line">        <span class="keyword">new</span> DrawableImageViewTarget(view),</span><br><span class="line">        <span class="keyword">null</span>,</span><br><span class="line">        requestOptions,</span><br><span class="line">        Executors.mainThreadExecutor());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> &lt;Y extends Target&lt;TranscodeType&gt;&gt; <span class="function">Y <span class="title">into</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  @NonNull Y target,</span></span></span><br><span class="line"><span class="function"><span class="params">  @Nullable RequestListener&lt;TranscodeType&gt; targetListener,</span></span></span><br><span class="line"><span class="function"><span class="params">  RequestOptions options)</span> </span>&#123;    </span><br><span class="line">    Request request = buildRequest(target, targetListener, options);</span><br><span class="line">    Request previous = target.getRequest();</span><br><span class="line">	...</span><br><span class="line">    requestManager.clear(target);</span><br><span class="line">    target.setRequest(request);</span><br><span class="line">    requestManager.track(target, request);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆçš„éƒ¨åˆ†éœ€è¦åˆ›å»º buildRequestï¼Œé‚£ä¹ˆè¿™ä¸ªbuildRequestç©¶ç«Ÿåšäº†ä»€ä¹ˆï¼Ÿé€šè¿‡é˜…è¯»æºç æˆ‘ä»¬å‘ç°buildRequeståªæ˜¯ç®€å•çš„è°ƒç”¨buildRequestRecursiveå‡½æ•°ï¼Œé‚£å°±å…·ä½“åˆ†æbuildRequestRecursive</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Request <span class="title">buildRequestRecursive</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    Target&lt;TranscodeType&gt; target,</span></span></span><br><span class="line"><span class="function"><span class="params">    @Nullable RequestListener&lt;TranscodeType&gt; targetListener,</span></span></span><br><span class="line"><span class="function"><span class="params">    @Nullable RequestCoordinator parentCoordinator,</span></span></span><br><span class="line"><span class="function"><span class="params">    TransitionOptions&lt;?, ? <span class="keyword">super</span> TranscodeType&gt; transitionOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    Priority priority,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> overrideWidth,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> overrideHeight,</span></span></span><br><span class="line"><span class="function"><span class="params">    BaseRequestOptions&lt;?&gt; requestOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    Executor callbackExecutor)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Build the ErrorRequestCoordinator first if necessary so we can update parentCoordinator.</span></span><br><span class="line">    ErrorRequestCoordinator errorRequestCoordinator = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (errorBuilder != <span class="keyword">null</span>) &#123;</span><br><span class="line">        errorRequestCoordinator = <span class="keyword">new</span> ErrorRequestCoordinator(parentCoordinator);</span><br><span class="line">        parentCoordinator = errorRequestCoordinator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¼©ç•¥å›¾æˆ–è€…åŸå›¾Request</span></span><br><span class="line">    Request mainRequest =</span><br><span class="line">        buildThumbnailRequestRecursive(</span><br><span class="line">        target,</span><br><span class="line">        targetListener,</span><br><span class="line">        parentCoordinator,</span><br><span class="line">        transitionOptions,</span><br><span class="line">        priority,</span><br><span class="line">        overrideWidth,</span><br><span class="line">        overrideHeight,</span><br><span class="line">        requestOptions,</span><br><span class="line">        callbackExecutor);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (errorRequestCoordinator == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> mainRequest;</span><br><span class="line">    &#125;</span><br><span class="line">	...</span><br><span class="line">    Request errorRequest =</span><br><span class="line">        errorBuilder.buildRequestRecursive(</span><br><span class="line">        target,</span><br><span class="line">        targetListener,</span><br><span class="line">        errorRequestCoordinator,</span><br><span class="line">        errorBuilder.transitionOptions,</span><br><span class="line">        errorBuilder.getPriority(),</span><br><span class="line">        errorOverrideWidth,</span><br><span class="line">        errorOverrideHeight,</span><br><span class="line">        errorBuilder,</span><br><span class="line">        callbackExecutor);</span><br><span class="line">    errorRequestCoordinator.setRequests(mainRequest, errorRequest);</span><br><span class="line">    <span class="keyword">return</span> errorRequestCoordinator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ£€æµ‹åˆ°å¦‚æœé™¤äº†ç›®æ ‡å›¾ç‰‡å¤–ï¼Œæˆ‘ä»¬è¿˜è‡ªå·±é…ç½®äº†æ˜¾ç¤ºçš„é”™è¯¯å›¾ç‰‡ï¼Œæˆ–ç¼©ç•¥å›¾æ˜¾ç¤ºï¼Œé‚£ä¹ˆè¿™æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªè¯·æ±‚åè°ƒå™¨ï¼Œæ¥åè°ƒå„ç±»å‹å›¾ç‰‡é—´çš„è¯·æ±‚é¡ºåºã€‚</p>
<ul>
<li>åœ¨æ„å»ºåè°ƒå™¨åï¼Œä¼šå°†ç›®æ ‡å›¾ç‰‡è¯·æ±‚å’Œé”™è¯¯å›¾ç‰‡è¯·æ±‚è®¾ç½®ç»™åè°ƒå™¨ã€‚</li>
<li>ä¸€æ—¦è¯·æ±‚å¼€å§‹å·¥ä½œï¼Œå°±ä¼šå¯åŠ¨ç›®æ ‡å›¾ç‰‡è¯·æ±‚ã€‚</li>
<li>å½“ç›®æ ‡å›¾ç‰‡è¯·æ±‚å¤±è´¥æ—¶ï¼Œå°±ä¼šå¯åŠ¨é”™è¯¯å›¾ç‰‡è¯·æ±‚ã€‚</li>
</ul>
<p>buildThumbnailRequestRecursiveä¸­é™¤äº†åˆ›å»ºç¼©ç•¥å›¾å¤–ï¼Œè¿˜æœ‰å¯èƒ½ä¼šå»åŠ è½½åŸå›¾ã€‚æ­¤å¤„ä¸ºäº†ç®€åŒ–åˆ†æï¼Œæˆ‘ä»¬åªçœ‹åŠ è½½åŸé¢˜çš„å®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Request <span class="title">obtainRequest</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    Target&lt;TranscodeType&gt; target,</span></span></span><br><span class="line"><span class="function"><span class="params">    RequestListener&lt;TranscodeType&gt; targetListener,</span></span></span><br><span class="line"><span class="function"><span class="params">    BaseRequestOptions&lt;?&gt; requestOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    RequestCoordinator requestCoordinator,</span></span></span><br><span class="line"><span class="function"><span class="params">    TransitionOptions&lt;?, ? <span class="keyword">super</span> TranscodeType&gt; transitionOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">    Priority priority,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> overrideWidth,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> overrideHeight,</span></span></span><br><span class="line"><span class="function"><span class="params">    Executor callbackExecutor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> SingleRequest.obtain(</span><br><span class="line">        context,</span><br><span class="line">        glideContext,</span><br><span class="line">        model,</span><br><span class="line">        transcodeClass,</span><br><span class="line">        requestOptions,</span><br><span class="line">        overrideWidth,</span><br><span class="line">        overrideHeight,</span><br><span class="line">        priority,</span><br><span class="line">        target,</span><br><span class="line">        targetListener,</span><br><span class="line">        requestListeners,</span><br><span class="line">        requestCoordinator,</span><br><span class="line">        glideContext.getEngine(),</span><br><span class="line">        transitionOptions.getTransitionFactory(),</span><br><span class="line">        callbackExecutor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸå›¾çš„åŠ è½½å®Œå…¨äº¤ç»™äº†SingleRequestå®ç°ã€‚æˆ‘ä»¬å›åˆ°åˆšæ‰intoæ–¹æ³•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°åœ¨åšäº†å¿…è¦çš„å‡†å¤‡åï¼Œæˆ‘ä»¬æœ€ç»ˆå›åˆ°<strong>RequestManager#track</strong>æ–¹æ³•ï¼Œå°†æ­¤æ¬¡è¯·æ±‚æ”¾åˆ°RequestManagerçš„è¯·æ±‚é˜Ÿåˆ—ä¸­ï¼ŒåŒæ—¶æ£€æµ‹å½“å‰ç”Ÿå‘½å‘¨æœŸæ˜¯å¦å·²ç»æš‚åœï¼Œå¦åˆ™ç›´æ¥å‘èµ·åŠ è½½è¯·æ±‚ï¼Œå¯¹æ­¤ï¼Œæ˜¯å‘èµ·äº†ä¸€æ¬¡SingleRequestè¯·æ±‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">track</span><span class="params">(Target&lt;?&gt; target, Request request)</span> </span>&#123;</span><br><span class="line">    targetTracker.track(target);</span><br><span class="line">    requestTracker.runRequest(request);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//RequestTracker#runRequest</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runRequest</span><span class="params">(Request request)</span> </span>&#123;</span><br><span class="line">    requests.add(request);</span><br><span class="line">    <span class="keyword">if</span> (!isPaused) &#123;</span><br><span class="line">      request.begin();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      pendingRequests.add(request);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-èµ„æºåŠ è½½"><a href="#6-èµ„æºåŠ è½½" class="headerlink" title="6. èµ„æºåŠ è½½"></a>6. èµ„æºåŠ è½½</h3><p>ç”±ä»¥ä¸Šåˆ†ææˆ‘ä»¬å¾—çŸ¥ï¼Œæœ€ç»ˆåŠ è½½å›¾ç‰‡æ˜¯äº¤ä»£ç»™SingleRequestæ¥å®ç°çš„ï¼Œå…·ä½“æºç å¦‚ä¸‹ï¼Œé™¤äº†è®¾ç½®å½“å‰çš„çŠ¶æ€å¤–ï¼Œæœ€é‡è¦çš„è«è¿‡äºonSizeReadyæ¥å£äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">begin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (status == Status.COMPLETE) &#123;</span><br><span class="line">        onResourceReady(resource, DataSource.MEMORY_CACHE);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    status = Status.WAITING_FOR_SIZE;</span><br><span class="line">    <span class="keyword">if</span> (Util.isValidDimensions(overrideWidth, overrideHeight)) &#123;</span><br><span class="line">        onSizeReady(overrideWidth, overrideHeight);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        target.getSize(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((status == Status.RUNNING || status == Status.WAITING_FOR_SIZE)</span><br><span class="line">        &amp;&amp; canNotifyStatusChanged()) &#123;</span><br><span class="line">        target.onLoadStarted(getPlaceholderDrawable());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onSizeReady</span><span class="params">(<span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">    status = Status.RUNNING;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">float</span> sizeMultiplier = requestOptions.getSizeMultiplier();</span><br><span class="line">    <span class="keyword">this</span>.width = maybeApplySizeMultiplier(width, sizeMultiplier);</span><br><span class="line">    <span class="keyword">this</span>.height = maybeApplySizeMultiplier(height, sizeMultiplier);</span><br><span class="line"></span><br><span class="line">    loadStatus =</span><br><span class="line">        engine.load(</span><br><span class="line">        glideContext,</span><br><span class="line">        model,</span><br><span class="line">        requestOptions.getSignature(),</span><br><span class="line">        <span class="keyword">this</span>.width,</span><br><span class="line">        <span class="keyword">this</span>.height,</span><br><span class="line">        requestOptions.getResourceClass(),</span><br><span class="line">        transcodeClass,</span><br><span class="line">        priority,</span><br><span class="line">        requestOptions.getDiskCacheStrategy(),</span><br><span class="line">        requestOptions.getTransformations(),</span><br><span class="line">        requestOptions.isTransformationRequired(),</span><br><span class="line">        requestOptions.isScaleOnlyOrNoTransform(),</span><br><span class="line">        requestOptions.getOptions(),</span><br><span class="line">        requestOptions.isMemoryCacheable(),</span><br><span class="line">        requestOptions.getUseUnlimitedSourceGeneratorsPool(),</span><br><span class="line">        requestOptions.getUseAnimationPool(),</span><br><span class="line">        requestOptions.getOnlyRetrieveFromCache(),</span><br><span class="line">        <span class="keyword">this</span>,</span><br><span class="line">        callbackExecutor);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>onSizeReadyåˆ™é€šè¿‡Glideçš„å¼•æ“ï¼ŒçœŸæ­£çš„å»åŠ è½½èµ„æºã€‚å…³äºGlideçš„å¼•æ“ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åšè¿‡å¤šçš„ä»‹ç»ï¼Œå…¶è´Ÿè´£ä»»åŠ¡åˆ›å»ºï¼Œå‘èµ·ï¼Œå›è°ƒï¼Œèµ„æºçš„ç®¡ç†ç­‰ï¼Œæ­¤å¤„ç®€å•åˆ†æloadçš„å®ç°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;R&gt; <span class="function">LoadStatus <span class="title">load</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    GlideContext glideContext,</span></span></span><br><span class="line"><span class="function"><span class="params">    Object model,</span></span></span><br><span class="line"><span class="function"><span class="params">    Key signature,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> width,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> height,</span></span></span><br><span class="line"><span class="function"><span class="params">    Class&lt;?&gt; resourceClass,</span></span></span><br><span class="line"><span class="function"><span class="params">    Class&lt;R&gt; transcodeClass,</span></span></span><br><span class="line"><span class="function"><span class="params">    Priority priority,</span></span></span><br><span class="line"><span class="function"><span class="params">    DiskCacheStrategy diskCacheStrategy,</span></span></span><br><span class="line"><span class="function"><span class="params">    Map&lt;Class&lt;?&gt;, Transformation&lt;?&gt;&gt; transformations,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">boolean</span> isTransformationRequired,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">boolean</span> isScaleOnlyOrNoTransform,</span></span></span><br><span class="line"><span class="function"><span class="params">    Options options,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">boolean</span> isMemoryCacheable,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">boolean</span> useUnlimitedSourceExecutorPool,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">boolean</span> useAnimationPool,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">boolean</span> onlyRetrieveFromCache,</span></span></span><br><span class="line"><span class="function"><span class="params">    ResourceCallback cb)</span> </span>&#123;</span><br><span class="line">    Util.assertMainThread();</span><br><span class="line">    <span class="keyword">long</span> startTime = LogTime.getLogTime();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1:åˆ›å»ºèµ„æºç´¢å¼•key</span></span><br><span class="line">    EngineKey key = keyFactory.buildKey(model, signature, width, height, transformations,</span><br><span class="line">                                        resourceClass, transcodeClass, options);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2:ä»å†…å­˜ä¸­å½“å‰æ­£åœ¨æ˜¾ç¤ºçš„èµ„æºç¼“å­˜åŠ è½½å›¾ç‰‡</span></span><br><span class="line">    EngineResource&lt;?&gt; active = loadFromActiveResources(key, isMemoryCacheable);</span><br><span class="line">    <span class="keyword">if</span> (active != <span class="keyword">null</span>) &#123;</span><br><span class="line">        cb.onResourceReady(active, DataSource.MEMORY_CACHE);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3:ä»å†…å­˜ç¼“å­˜èµ„æºä¸­åŠ è½½å›¾ç‰‡</span></span><br><span class="line">    EngineResource&lt;?&gt; cached = loadFromCache(key, isMemoryCacheable);</span><br><span class="line">    <span class="keyword">if</span> (cached != <span class="keyword">null</span>) &#123;</span><br><span class="line">        cb.onResourceReady(cached, DataSource.MEMORY_CACHE);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4:è·å–å·²ç»å­˜åœ¨çš„åŠ è½½ä»»åŠ¡</span></span><br><span class="line">    EngineJob&lt;?&gt; current = jobs.get(key, onlyRetrieveFromCache);</span><br><span class="line">    <span class="keyword">if</span> (current != <span class="keyword">null</span>) &#123;</span><br><span class="line">        current.addCallback(cb);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LoadStatus(cb, current);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5:æ–°å»ºåŠ è½½ä»»åŠ¡ï¼Œç”¨äºå¯åŠ¨è§£ç ä»»åŠ¡</span></span><br><span class="line">    EngineJob&lt;R&gt; engineJob =</span><br><span class="line">        engineJobFactory.build(</span><br><span class="line">        key,</span><br><span class="line">        isMemoryCacheable,</span><br><span class="line">        useUnlimitedSourceExecutorPool,</span><br><span class="line">        useAnimationPool,</span><br><span class="line">        onlyRetrieveFromCache);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6:æ–°å»ºè§£ç ä»»åŠ¡ï¼ŒçœŸæ­£æ‰§è¡Œæ•°æ®åŠ è½½å’Œè§£ç çš„ç±»</span></span><br><span class="line">    DecodeJob&lt;R&gt; decodeJob =</span><br><span class="line">        decodeJobFactory.build(</span><br><span class="line">        glideContext,</span><br><span class="line">        model,</span><br><span class="line">        key,</span><br><span class="line">        signature,</span><br><span class="line">        width,</span><br><span class="line">        height,</span><br><span class="line">        resourceClass,</span><br><span class="line">        transcodeClass,</span><br><span class="line">        priority,</span><br><span class="line">        diskCacheStrategy,</span><br><span class="line">        transformations,</span><br><span class="line">        isTransformationRequired,</span><br><span class="line">        isScaleOnlyOrNoTransform,</span><br><span class="line">        onlyRetrieveFromCache,</span><br><span class="line">        options,</span><br><span class="line">        engineJob);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//7:ç¼“å­˜åŠ è½½ä»»åŠ¡</span></span><br><span class="line">    jobs.put(key, engineJob);</span><br><span class="line"></span><br><span class="line">    engineJob.addCallback(cb);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//8:å¼€å¯è§£ç ä»»åŠ¡</span></span><br><span class="line">    engineJob.start(decodeJob);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> LoadStatus(cb, engineJob);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬çœŸæ­£å¼€å¯äº†èµ„æºçš„åŠ è½½è¿‡ç¨‹ï¼Œå¼•æ“ä¸­çš„loadä¼šæ ¹æ®å½“å‰å†…å­˜æ˜¯å¦å­˜åœ¨æ­¤èµ„æºè¿›è¡Œç›¸åº”çš„åŠ è½½ï¼Œå¦åˆ™å†å»è¯·æ±‚æœ¬åœ°ç£ç›˜æˆ–è€…ç½‘ç»œç­‰ï¼Œæ­¤è¯·æ±‚ä»»åŠ¡åˆ™äº¤ç»™Registryä¸­å·²ç»æ³¨å†Œçš„ModelLoaderæ¥å®Œæˆï¼Œè§ç¬¬äºŒèŠ‚Registryã€‚</p>
  	
					
	  </div>     
	  

	<div class="bottom">
  <div class="other">
    <div class="meta">
      
      <i class="iconfont icon-category"></i>
      <a class="category-link" href="/categories/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">æºç åˆ†æ</a>

      

      
      <i class="iconfont icon-tag"></i>
      <a class="tag-link" href="/tags/Glide/" rel="tag">Glide</a> <a class="tag-link" href="/tags/%E5%9B%BE%E5%83%8F%E5%8A%A0%E8%BD%BD/" rel="tag">å›¾åƒåŠ è½½</a>
      
    </div>

    <div class="operate">
      
      <span class="text">Share</span>
      <ul class="share">
	   			             
        <li class="iconfont 
		icon-share-qq 
		-mob-share-qq 
		item"></li>		
   	   			             
        <li class="iconfont 
		icon-share-weixin 
		-mob-share-weixin 
		item"></li>		
   	   			             
        <li class="iconfont 
		icon-share-weibo 
		-mob-share-weibo 
		item"></li>		
   	   
</ul>	

<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=21d601593a1de"></script>
      
    </div>
  </div>


  
  <nav class="nav">
    <div class="link">
      
      <a href="/2018/10/01/Android%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/" class="link-wrap">
        <strong class="caption">older</strong>
        
        <span class="title">
          Androidæ¸²æŸ“æœºåˆ¶
        </span>
      </a>
      
    </div>
    <div class="link">
      
      <a href="/2019/10/25/%E4%BB%8Ejava%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E8%AF%B4%E8%B5%B7/" class="link-wrap">
        <strong class="caption">newer</strong>
        
        <span class="title">
          ä»javaå¯¹è±¡åˆ›å»ºè¯´èµ·
        </span>
      </a>
      
    </div>
  </nav>
  
</div> 
	
<div class="comment">

    

    <div id="comment">
    </div>

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>

    <script src="//unpkg.com/valine@v1.1.8-beta/dist/Valine.min.js"></script>

    <script>
        new Valine({
            el: '#comment',
            notify: false,
            verify: false,
            app_id: 'cFM0eCo0CQ9xmBXmHi1eltol-gzGzoHsz',
            app_key: 'oh9tizsnvV2vNvWgqEvoNtQO',
            path: window.location.pathname,
            avatar: 'mm',
            guest_info: ['nick', 'mail']
        });
    </script>
    
</div>	
</article>

          </div> 
      </div>            
    
        <i id="toTop" class="iconfont icon-backtotop"></i>

  
    <div class="none" id="search">
    <div class="header">
        <input type="text" placeholder="è¾“å…¥ä½ æƒ³æœç´¢çš„" id="search-input" class="input">
        
        <i id="search-cancel" class="iconfont icon-cancel"></i>
    </div>

    <div id="search-result" class="result"></div>
</div>
     <div class="mobile-menu">      

      
      <img class="mobile-menu-icon" src="/images/favicon.png">  
      

         
            

            <a class="mobile-menu-link" href="/">é¦–é 
            </a>
            
         
            

            <a class="mobile-menu-link" href="/archives">æ­¸æª”
            </a>
            
         
            

            <a class="mobile-menu-link" href="/tags">æ¨™ç±¤
            </a>
            
         
            

            <a class="mobile-menu-link" href="/about">é—œæ–¼
            </a>
            
         
                          

            <a class="mobile-menu-link mobile-menu-search" href="#">æœç´¢ </a>                 
            
         
      
</div>
        
    



     
    


<footer class="footer">
	<div class="inner">
		<div class="copyright">
			&copy;
			
			2019
			Lemon

			<br>
			By <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a>
		</div>
	</div>
</footer>   

    <script src="/nayo.bundle.js"></script>           
  </body>        
</html>